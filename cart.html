<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cart</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col items-center justify-center">
  <div class="bg-white rounded-lg shadow-lg p-8 w-full max-w-lg">
    <h1 class="text-2xl font-bold mb-4 text-center">Your Cart</h1>
    <div id="cartItems" class="space-y-4"></div>
    <div id="cartTotal" class="mt-6 text-xl font-bold text-blue-700 text-center"></div>
    <a href="index.html" class="block mt-6 text-blue-600 hover:underline text-center">Back to Home</a>
  </div>
  <script>
    const PRODUCTS = JSON.parse(localStorage.getItem('productsCache')) || [];
    const cart = JSON.parse(localStorage.getItem('cart') || '[]');
    function renderCart() {
      const container = document.getElementById('cartItems');
      let total = 0;
      if (cart.length === 0) {
        container.innerHTML = '<div class="text-gray-400 text-center">Your cart is empty.</div>';
        document.getElementById('cartTotal').textContent = '';
        return;
      }
      container.innerHTML = cart.map(id => {
        const prod = PRODUCTS.find(p => p.id === id);
        if (!prod) return '';
        total += prod.price;
        return `<div class='flex items-center gap-4 bg-gray-100 rounded p-4'>
          <img src='${prod.image_url}' alt='${prod.name}' class='w-16 h-16 object-cover rounded'>
          <div>
            <div class='font-semibold text-lg'>${prod.name}</div>
            <div class='text-gray-500'>${prod.category}</div>
            <div class='text-blue-600 font-bold'>₹${prod.price.toFixed(2)}</div>
          </div>
        </div>`;
      }).join('');
      document.getElementById('cartTotal').textContent = `Total: ₹${total.toFixed(2)}`;
    }
    // Cache products if not already
    if (!PRODUCTS.length && window.opener && window.opener.PRODUCTS) {
      localStorage.setItem('productsCache', JSON.stringify(window.opener.PRODUCTS));
      location.reload();
    } else {
      renderCart();
    }
  </script>
</body>
</html>
